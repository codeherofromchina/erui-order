<script type="text/javascript">
    var supplierDialogParams = getQueryStringFromGlobalParams();
</script>
<!-- 供应商弹出框 -->
<table id="common_supplier_dialog_table" toolbar="#common_supplier_dialog_table_toolbar">
    <thead>
    <tr>
        <th field="serial_no" width="25%">供应商编码</th>
        <th field="supplier_type" data-options="formatter:function(code){
            switch(code){
                case 'MANUFACTURER':
                    return '制造商';
                case 'AGENCY':
                    return '代理商';
                case 'DISTRIBUTOR':
                    return '经销商';
                case 'SERVICE_PROVIDER':
                    return '服务商';
                case 'LOGISTICS_PROVIDER':
                    return '物流商';
                default:
                    return code;
            }
        }" width="25%">供应商类型</th>
        <th field="name" width="45%">供应商名称</th>
    </tr>
    </thead>
</table>

<div class="toolbar" id="common_supplier_dialog_table_toolbar">
    <div class="search-div">
        <form id="common_supplier_dialog_table_toolbar_form">
            <label>供应商编码：</label>
            <input name="supplier_no" type="text" class="easyui-textbox"  />
            <label>供应商类型：</label>
            <select class="easyui-combobox" editable="false" name="supplier_type">
                <option code="">请选择</option>
                <option code="MANUFACTURER">制造商</option>
                <option code="AGENCY">代理商</option>
                <option code="DISTRIBUTOR">经销商</option>
                <option code="SERVICE_PROVIDER">服务商</option>
                <option code="LOGISTICS_PROVIDER">物流商</option>
            </select>
            <label>供应商名称：</label>
            <input name="name" type="text" class="easyui-textbox"  />

            <a href="javascript:void(0);" id="common_supplier_dialog_toolbar_form_search" class="easyui-linkbutton" iconCls="icon-search">搜索</a>
            <a href="javascript:void(0);" id="common_supplier_dialog_toolbar_form_clear" class="easyui-linkbutton" iconCls="icon-clear">清空</a>
        </form>
    </div>
</div>


<script type="text/javascript">
    $(function(){
        $("#common_supplier_dialog_table").datagrid({
            fitColumns:true,
            border:false,
            fit:true,
            singleSelect:true,
            method:'post',
            rownumbers:true,
            striped:true,
            pagination:true,
            url:'http://api.eruidev.com/v3/Supplier/Suppliers/getList',
            onBeforeLoad:function(param){
                var page = param.page; //保存下值
                var rows = param.rows; //保存下值
                delete param.page; //删掉
                delete param.rows; //删掉
                param.orderStatus = "APPROVED";
                param.rows = rows;
                param.currentPage = page;
                var data = $('#common_supplier_dialog_table_toolbar_form').serializeJson();
                if (data) {
                    for(var attr in data){
                        param[attr]= data[attr];
                    }
                }
            },
            loader:function(param,success,error) {
                var opts = $(this).datagrid("options");
                return tokenAjaxLoader(opts,param,success,error);
            },
            loadFilter:function(data) {
                var finalData = {"total":0,"rows":[]};
                if (data.code == 1) {
                    finalData.total = data.data.count;
                    if (data.data) {
                        finalData.rows = data.data.data;
                    }
                }
                return finalData;
            }
        });
        $("#common_supplier_dialog_toolbar_form_search").click(function () {
            $("#common_supplier_dialog_table").datagrid("reload");
        });
        $("#common_supplier_dialog_toolbar_form_clear").click(function () {
            $("#common_supplier_dialog_table_toolbar_form").form("clear");
            $("#common_supplier_dialog_table").datagrid("reload");
        });
    })

</script>