<script type="text/javascript">
    var inspectApplyListPagePurchId;
    var inspectApplyListQueryObj = getQueryStringFromGlobalParams();
    if (inspectApplyListQueryObj.purchaseId) {
        inspectApplyListPagePurchId = inspectApplyListQueryObj.purchaseId;
    }
</script>
<div class="easyui-panel" title="报检单列表"
     style="padding:10px;background:#fafafa;margin-bottom:10px;">
    <table id="inspect_apply_list_table">
        <thead>
        <tr>
            <th data-options="field:'purch_no'">采购合同号</th>
            <th data-options="field:'inspect_apply_no'">到货报检单号</th>
            <th data-options="field:'department'">下发部门</th>
            <th data-options="field:'purchase_name_id'">采购经办人</th>
            <th data-options="field:'supplier_name'">供应商名称</th>
            <th data-options="field:'inspect_date'">报检日期</th>
            <th data-options="field:'num'">报检次数</th>
            <th data-options="field:'pub_status'">质检结果</th>
            <th data-options="field:'_operate'">操作</th>
        </tr>
        </thead>
    </table>
</div>

<form id="add_inspect_apply_form">
    <div class="easyui-panel" title="基本信息"
         style="padding:10px;background:#fafafa;margin-bottom:10px;"
         data-options="collapsible:true">
        <div class="fitem">
            <label><span style="color:red;">*</span>订单类别：</label>
            <select class="easyui-combobox" id="add_inspect_apply_form_order_category_field" editable="false"
                    data-options="required:true"
                    validType="selectValueRequired['#add_inspect_apply_form_order_category_field']"
                    name="orderCategory">
                <option value="">请选择</option>
                <option value="1">预投</option>
                <option value="2">售后</option>
                <option value="3">试用</option>
                <option value="4">现货（出库）</option>
                <option value="5">订单</option>
                <option value="6">国内订单</option>
            </select>
            <label><span style="color:red;">*</span>海外销类型：</label>
            <select class="easyui-combobox" editable="false" id="add_inspect_apply_form_overseas_sales_field"
                    name="overseasSales"
                    data-options="required:true"
                    validType="selectValueRequired['#add_inspect_apply_form_overseas_sales_field']">
                <option value="">请选择订单类别</option>
                <option value="1">易瑞海外销（易瑞采购）</option>
                <option value="2">易瑞海外销（当地采购）</option>
                <option value="3">易瑞销</option>
            </select>
            <label>框架协议号：</label>
            <input class="easyui-textbox" data-options="validType:'length[0,32]'" name="frameworkNo"/>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>PO号：</label>
            <input class="easyui-textbox" required="true" name="poNo"/>
            <label>询单号：</label>
            <input class="easyui-textbox" name="inquiryNo"/>
            <label>海外销售合同号：</label>
            <input class="easyui-textbox" name="contractNoOs"/>
        </div>
        <div class="fitem">
            <label>授信情况：</label>
            <select class="easyui-combobox" name="grantType">
                <option value="">请选择</option>
                <option value="1">中信保</option>
                <option value="2">集团授信</option>
                <option value="3">无</option>
            </select>
            <label><span style="color:red;">*</span>合同交货日期：</label>
            <input class="easyui-textbox" required="true" name="deliveryDate"/>
            <label><span style="color:red;">*</span>市场经办人：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_agent_id_field" required="true" buttonText="请选择"
                   editable="false"
                   data-options="onClickButton:addOrderFormAgentUserFun" name="agentId"/>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>获取人：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_acquire_id_field" required="true" buttonText="请选择"
                   editable="false"
                   data-options="onClickButton:addOrderFormAcquireUserFun" name="acquireId"/>
            <label><span style="color:red;">*</span>客户签约主体公司：</label>
            <select class="easyui-combobox" editable="false" id="add_inspect_apply_form_signing_co_field"
                    name="signingCo"
                    data-options="required:true,valueField:'code',textField:'name',url:'resources/data/company.json',method:'get'"
                    validType="selectValueRequired['#add_inspect_apply_form_signing_co_field']">
            </select>
            <label><span style="color:red;">*</span>执行事业部：</label>
            <input class="easyui-textbox" name="businessUnitId" id="add_inspect_apply_form_business_unit_id_field"
                   required="true" buttonText="请选择" editable="false"
                   data-options="onClickButton:addOrderFormBusinessUnitFun"/>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>执行分公司：</label>
            <select class="easyui-combobox" editable="false" id="add_inspect_apply_form_exec_co_field" name="execCoCode"
                    data-options="required:true,valueField:'code',textField:'name',url:'resources/data/company.json',method:'get'"
                    validType="selectValueRequired['#add_inspect_apply_form_exec_co_field']">
            </select>
            <label><span style="color:red;">*</span>国家：</label>
            <input id="add_inspect_apply_form_region_field" style="width: 92px;" name="region" value="">
            <input id="add_inspect_apply_form_country_field" style="width:92px;" name="country" value=""/>
            <label><span style="color:red;">*</span>CRM客户代码：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_crm_code_field" required="true" buttonText="请选择"
                   editable="false"
                   data-options="onClickButton:addOrderFormCrmCodeFun" name="buyerId"/>
        </div>

        <div class="fitem">
            <label><span style="color:red;">*</span>客户类型：</label>
            <select class="easyui-combobox" name="customerType">
                <option value="">请选择</option>
                <option value="1">油气</option>
                <option value="0">非油气</option>
            </select>
            <label><span style="color:red;">*</span>回款负责人：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_per_liable_repay_id_field" required="true"
                   buttonText="请选择"
                   editable="false" data-options="onClickButton:addOrderFormPerLiableRepayIdFun"
                   name="perLiableRepayId"/>
            <label><span style="color:red;">*</span>事业部项目负责人：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_technical_id_field" required="true"
                   buttonText="请选择"
                   editable="false" data-options="onClickButton:addOrderFormTechnicalIdFun" name="technicalId"/>
        </div>
        <div class="fitem">
            <label>是否融资项目：</label>
            <select class="easyui-combobox" editable="false" name="financing">
                <option value="">请选择</option>
                <option value="1">融资</option>
                <option value="0">不融资</option>
            </select>
            <label>运输方式：</label>
            <select class="easyui-combobox" editable="false" id="add_inspect_apply_form_transport_type_field"
                    name="transportType">
                <option value="">请选择</option>
                <option value="Ocean">海运</option>
                <option value="Air">空运</option>
                <option value="Multimodal">多式联运</option>
                <option value="Road">公路</option>
                <option value="Railway Containers">铁路</option>
                <option value="International Express">国际快递</option>
            </select>
            <label><span style="color:red;">*</span>贸易术语：</label>
            <select class="easyui-combobox" id="add_inspect_apply_form_trade_terms_field" editable="false"
                    data-options="required:true"
                    validType="selectValueRequired['#add_inspect_apply_form_trade_terms_field']"
                    name="tradeTerms">
                <option value="">请选择</option>
                <option value="CFR">CFR</option>
                <option value="CIF">CIF</option>
                <option value="CIP">CIP</option>
                <option value="CPT">CPT</option>
                <option value="DAP">DAP</option>
                <option value="DAT">DAT</option>
                <option value="DDP">DDP</option>
                <option value="EXW">EXW</option>
                <option value="FCA">FCA</option>
                <option value="FOB">FOB</option>
            </select>
        </div>
        <div class="fitem">
            <label>起运港：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_from_port_field" buttonText="请选择" editable="false"
                   data-options="onClickButton:addOrderFormFromPortFun" name="fromPort"/>
            <label>起运国：</label>
            <input class="easyui-textbox" editable="false" id="add_inspect_apply_form_from_country_field"
                   name="fromCountry"/>
            <label>发运起始地：</label>
            <input class="easyui-textbox" value="" name="fromPlace"/>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>目的港：</label>
            <input class="easyui-textbox" id="add_inspect_apply_form_to_port_field" required="true" buttonText="请选择"
                   editable="false"
                   data-options="onClickButton:addOrderFormToPortFun" name="toPort"/>
            <label>目的国：</label>
            <input class="easyui-textbox" editable="false" id="add_inspect_apply_form_to_country_field"
                   name="toCountry"/>
            <label>目的地：</label>
            <input class="easyui-textbox" value="" name="toPlace"/>
        </div>
    </div>

    <div id="add_inspect_apply_panel_goods_info" class="easyui-panel" title="商品信息"
         style="padding:2px;background:#fafafa;margin-bottom:10px;"
         data-options="collapsible:true">
        <table id="add_inspect_apply_panel_goods_info_table" style="background:#fafafa;">
            <thead>
            <tr>
                <th field="sku">平台SKU</th>
                <th field="meteTypeName"><span style="color:red;">*</span>物料分类</th>
                <th field="tplName"><span style="color:red;">*</span>模板名称</th>
                <th field="departmentName"><span style="color:red;">*</span>商品所属事业部</th>
                <th field="nameEn">外文品名</th>
                <th field="nameZh"><span style="color:red;">*</span>中文品名</th>
                <th field="contractGoodsNum"><span style="color:red;">*</span>合同数量</th>
                <th field="unitName">单位</th>
                <th field="price">客户销售单价</th>
                <th field="eruiPrice">易瑞销售单价</th>
                <th field="purchContractBrand">品牌</th>
                <th field="totalPrice">金额</th>
            </tr>
            </thead>
        </table>
    </div>

    <div id="add_inspect_apply_panel_contract_info" class="easyui-panel" title="合同信息"
         style="padding:10px;background:#fafafa;margin-bottom:10px;"
         data-options="collapsible:true">
        <div class="fitem">
            <label>客户合同金额：</label>
            <input class="easyui-numberbox" precision="2" value="0" id="add_inspect_apply_form_total_price_field"
                   name="totalPrice" editable="false"
                   style="width:100px;"/>
            <select class="easyui-combobox" style="width:80px;" name="currencyBn">
                <option value="CAD">CAD</option>
                <option value="CNY">CNY</option>
                <option value="EUR">EUR</option>
                <option value="USD" selected>USD</option>
            </select>
            <label>易瑞合同金额：</label>
            <input class="easyui-numberbox" precision="2" value="0" id="add_inspect_apply_form_erui_total_price_field"
                   name="eruiTotalPrice" editable="false"
                   style="width:100px;"/>
            <select class="easyui-combobox" style="width:80px;">
                <option value="CAD">CAD</option>
                <option value="CNY">CNY</option>
                <option value="EUR">EUR</option>
                <option value="USD" selected>USD</option>
            </select>
            <label><span style="color:red;">*</span>是否含税：</label>
            <select class="easyui-combobox" editable="false" name="taxBearing">
                <option value="">请选择</option>
                <option value="1">含税</option>
                <option value="2">不含税</option>
            </select>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>汇率：</label>
            <input class="easyui-numberbox" data-options="min:0,precision:4" value="1"
                   id="add_inspect_apply_form_exchange_rate_field" name="exchangeRate"
                   style="width:120px;"/>
            <span style="width:80px;color:blue;"> 兑美金汇率</span>

            <label>客户合同USD金额：</label>
            <input class="easyui-numberbox" data-options="min:0,precision:4" value="0"
                   id="add_inspect_apply_form_total_price_usd_field" name="totalPriceUsd" editable="false"/>
            <label>质保金：</label>
            <input class="easyui-numberbox" data-options="min:0,precision:2" value="" name="qualityFunds"
                   style="width: 150px;"/> <span class="standard_currency" style="color:blue;"> USD</span>
        </div>
        <div class="fitem">
            <label><span style="color:red;">*</span>收款方式：</label>
            <select class="easyui-combobox" editable="false" name="paymentModeBn">
                <option value="">请选择</option>
                <option value="1">信用证</option>
                <option value="2">托收</option>
                <option value="3">电汇</option>
                <option value="4">信汇</option>
                <option value="5">票汇</option>
                <option value="6">现金</option>
            </select>
            <input type="hidden" value="1" name="orderPayments0.paymentType"/>
            <label>预收货款：</label>
            <input class="easyui-numberbox" data-options="min:0,precision:2" name="orderPayments0.money"
                   style="width: 150px;"/> <span class="standard_currency" style="width: 30px;color:blue;"> USD</span>
            <label>收款日期：</label>
            <input class="easyui-datebox" value="" name="orderPayments0.receiptDate" ediable="false"
                   style="width: 150px;"/>
        </div>
        <div id="add_inspect_apply_order_payment_div">
        </div>


        <div id="add_inspect_apply_panel_contract_info_add_btn_div">
            <a href="javascript:void(0);" id="add_inspect_apply_panel_contract_info_add_btn" class="easyui-linkbutton">添加收款</a>
        </div>
    </div>


    <div id="add_inspect_apply_panel_other_info" class="easyui-panel" title="其他信息"
         style="padding:10px;background:#fafafa;margin-bottom:10px;"
         data-options="collapsible:true">
        <div class="fitem">
            <label style="width:120px;">交货要求描述：</label>
            <input class="easyui-textbox" multiline="true" style="width:560px;height:60px;" value=""
                   name="deliveryRequires"/>
        </div>
        <div class="fitem">
            <label style="width:120px;">客户及项目背景描述：</label>
            <input class="easyui-textbox" multiline="true" style="width:560px;height:60px;" value=""
                   name="customerContext"/>
        </div>
    </div>

    <div id="add_inspect_apply_panel_attachment_info" class="easyui-panel"
         title="附件（支持格式jpg、jpeg、png、gif、doc、docx、xls、xlsx、ppt、pptx、pdf、支持批量上传，单个附件不超过10M。）"
         style="background:#fafafa;margin-bottom:30px;"
         data-options="collapsible:true">
        <div class="easyui-layout" style="width: 100%;height:150px;">

            <div data-options="region:'west',split:false,border:false" style="width:150px;">
                <div style="text-align:center;">
                    <div style="margin-top:20px;margin-bottom:20px;"><span style="font-size: 14px;">市场</span></div>
                    <div style="margin-bottom:10px;"><a href="javascript:void(0);"
                                                        onclick="openFileDialog(1,'add_inspect_apply_form_attachment_table');"
                                                        class="easyui-linkbutton" plain="true">上传合同</a></div>
                    <div><a href="javascript:void(0);"
                            onclick="openFileDialog(2,'add_inspect_apply_form_attachment_table');"
                            class="easyui-linkbutton" plain="true">上传其它</a></div>
                </div>
            </div>
            <div data-options="region:'center',border:false" style="padding:5px;background:#eee;">
                <table class="easyui-datagrid" data-options="idField:'url'" singleSelect="true"
                       id="add_inspect_apply_form_attachment_table"
                       fit="true" fitColumn="true">
                    <thead>
                    <tr>
                        <th field="title" width="200">附件名称</th>
                        <th field="createUserName" width="120">创建人</th>
                        <th field="attachType" width="100" data-options="
                            formatter:function(value){
                                switch(value){
                                    case 1: return '合同';
                                    case 2: return '其它';
                                }
                                return value;
                            }
                            ">类型
                        </th>
                        <th field="createTime" width="170">日期</th>
                        <th field="_operate" width="80" data-options="formatter:formatOper">
                            操作
                        </th>
                    </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</form>
<div style="margin-top:20px;text-align: center;">
    <a href="javascript:void(0);" id="add_inspect_apply_form_save_btn" size="large" class="easyui-linkbutton"
       style="margin-right:10px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;保存&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
    <a href="javascript:void(0);" id="add_inspect_apply_form_submit_btn" size="large" class="easyui-linkbutton"
       style="margin-left:10px;">&nbsp;&nbsp;提交立项&nbsp;&nbsp;</a>
</div>


<script type="text/javascript">
    $(function () {
        $("#inspect_apply_list_table").datagrid({
            border: false,
            collapsible: false,
            url: LOCAL_URL + "/order/inspectApply/list",
            onBeforeLoad: function (param) {
                param.id = inspectApplyListPagePurchId;
            },
            loader: function (param, success, error) {
                var opts = $(this).combobox("options");
                return tokenAjaxLoader(opts, param, success, error);
            },
            loadFilter: tableLoadFilter
        });



    });

</script>